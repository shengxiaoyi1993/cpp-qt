# system_design
## 系统需求
- server-service
  - 监听对服务的连接
  - 对请求的相应
  - 管理登录的用户
  - 提供对直显相机的操作接口（api-串口操作）
  - 对设备连接状态的请求
- 服务器配置端
  - 对server-service的请求和对响应的处理
  - 响应用户的界面操作
  - 调用NVR配置界面对NVR进行配置
- 客户端
  - 对server-service的请求和对响应的处理
  - 响应用户的界面操作
  - 对相机的操作，直接与相机进行交互
  - 监听ws中发送的消息，做出对应的响应
  - 对数据进行综合分析，生成电子态势图





## 系统设计
- C/S架构，其中服务器端的服务器核心服务与服务器配置界面也是分离的，两者通过网络进行交互，以适应不同服务与控制位于不同电脑上的情况

- 使用MVC方式进行实现，因此可以先设计GUI界面，以后再添加模型

## 实现计划

- 设计原则
  - 文档与代码的先后顺序
  - 服务器与客户端的先后
  - 服务器与客户端相同设备的表现


> 先实现GUI，再添加已有功能，以虚拟方式展示没有的功能
> GUI界面文档编写（包含各个控件的触发和相应）->模型文档的编写->模型与界面交互:(可能对设备的行为没有理解到位而造成界面设计不当)
>先理解设备的输入输出和行为->然后设计界面->设计设备与界面的交互

- 文档编写计划
- 功能实现计划
- 测试计划

- 具体计划

```shell
1.实体设备的功能和行为
2.若干模块的划分
3.界面设计
4.具体编码
5.测试
```

## 实体设备
- 顶部四台全方位摄像机：自动跟踪功能开启与关闭、手动目标跟踪指引
- 专用直显相机 12 套(可见光)+12套(热红外)
- 两套 180 度 x300 米范围全景图像多目标监控:手动目标监控;自动目标跟踪;区域侦测报警联动

### 顶部相机

```
- 连接状态
- 相机输出视频流
- 识别物体输入
- 追踪模式切换
  - 自动跟踪功能：该模式下设备主动输出目标的位置；发给客户端；服务器端记录路径
  - 手动目标跟踪指引：需要客户端设定一个位置发给设备；然后由设备根据该图片模板跟踪视频中的物体
```

### 直显相机
```
- 连接状态
- 相机输出视频流到NVR
- 模式是热红外还是可见光
- 调整显示的区域
- 设备对在服务端以串口进行标识，在NVR端以ip进行标识
```

### 底部相机
```
- 连接状态
- 相机输出视频流
- 追踪模式切换
  - 自动跟踪功能：该模式下设备主动输出运动目标的位置；发给客户端；服务器端记录路径
  - 手动目标跟踪指引：客户端给定区域与移动方向，设备返回图片
  - 设置入侵监控区域
  - 监控设置的入侵监控区域；并报警
  - 设置巡航扫描路径
  - 设备根据巡航扫描路径进行扫描
```

### NVR
```
- 连接状态
- 接入相机
- 输出已录制的视频列表
- 自动录制视频
- 添加或删除录制的相机
- 提供查询接口
```
